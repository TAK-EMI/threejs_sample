<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>テンプレート</title>
	<script src="../lib/three.min.js"></script>
	<script src="../lib/js/controls/OrbitControls.js"></script>
</head>
<body>
	<a href="https://tak-emi.github.io/threejs_sample/">戻る</a><br>
	<form action="" id="form">
		<input type="checkbox" id="point" checked onclick="update()">点
		<input type="checkbox" id="edge" checked onclick="update()">線
		<input type="checkbox" id="face" checked onclick="update()">面
	</form>
	<canvas id="canvas"></canvas>
	<script>
		var scene = new THREE.Scene();
	</script>
	<script>
		const group = new THREE.Group();

		function update()
		{
			const elPoint = document.querySelector('#point');
			const elEdge = document.querySelector('#edge');
			const elFace = document.querySelector('#face');

			group.getObjectByName('point').visible = elPoint.checked;
			group.getObjectByName('wireframe').visible = elEdge.checked;
			group.getObjectByName('face').visible = elFace.checked;
		
			return;
		}
		function initBox()
		{
			const faceModel = new THREE.Mesh(
				new THREE.BoxGeometry(5, 5, 5),
				new THREE.MeshLambertMaterial({ color: 0x808080 })
			);
			faceModel.name = 'face';
			group.add(faceModel);
			
			const wireModel = new THREE.LineSegments(
				new THREE.WireframeGeometry(faceModel.geometry),
				new THREE.LineBasicMaterial({
					color: 0x000000,
					linewidth: 2
				})
			);
			wireModel.name = 'wireframe';
			group.add(wireModel);

			const pGeo = new THREE.BufferGeometry();
			const vertex = faceModel.geometry.vertices.slice();
			pGeo.attributes.position = new THREE.Float32BufferAttribute(vertex.map(vert => vert.toArray()).flat(), 3);
			const pointModel = new THREE.Points(
				pGeo,
				new THREE.PointsMaterial({
					size: 5,
					color: 0x000000,
					sizeAttenuation: false
				})
			);
			pointModel.name = 'point';
			group.add(pointModel);

			scene.add( group );

			update();
			
			return;
		}
	</script>
	<script>
		const width = 500;
		const height = 300;

		var camera = new THREE.PerspectiveCamera( 75, width / height, 0.1, 10000 );

		camera.position.set(10, 10, 10);

		var gridHelper = new THREE.GridHelper( 100, 100 );
		scene.add( gridHelper );

		var axesHelper = new THREE.AxesHelper( 1000 );
		scene.add( axesHelper );

		const light = new THREE.DirectionalLight(0xffffff);
		light.intensity = 2;
		light.position.set(2, 2, 1);
		scene.add(light);

		var renderer = new THREE.WebGLRenderer({
				canvas: document.querySelector("#canvas")
			});
		renderer.setSize( width, height );
		renderer.setClearColor(0xaaaaaa);

		const camController = new THREE.OrbitControls(camera, renderer.domElement);
		camController.update();

		initBox();

		function animate() {
			requestAnimationFrame( animate );

			camController.update();

			renderer.render( scene, camera );
		}

		animate();
	</script>
</body>
</html>
